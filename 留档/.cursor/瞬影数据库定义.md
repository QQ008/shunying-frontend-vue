# 主后台数据库

## 关系图：

## 表清单：

| / | 数据表 | 名称 | 备注 |
| --- | --- | --- | --- |
| 1 | WORKERS | 工作人员信息 |  |
| 2 | EVENTS | 赛事/活动信息 |  |
| 3 | EVENT_GROUPS | 赛事/活动组别信息 |  |
| 4 | LOCATION | 地点信息 |  |
| 5 | IMAGE_GROUPS | 图片组信息 |  |
| 6 | IMAGES | 单张图片信息 |  |
| 7 | IMAGE_GROUP_REL | 图片与图片组关系 |  |
| 8 | IMAGE_POST_SERVICE | 后期处理服务 |  |
| 9 | IMAGE_SERVICE_REL | 后期处理服务与图片关联 |  |
| 10 | IMAGE_SALES | 图片销售/定价信息 |  |
| 11 | DISCOUNT_POLICY | 折扣策略 |  |
| 12 | POLICY_IMAGE | 折扣策略与图片关联 |  |
| 13 | POLICY_USER_GROUP | 策略与用户分组关联 |  |
| 14 | USER_GROUP | 用户分组/会员等级 |  |
| 15 | USER_GROUP_REL | 用户与分组关联 |  |
| 16 | COUPONS | 优惠券信息 |  |
| 17 | USER_COUPONS | 用户优惠券 |  |
| 18 | USER | 用户信息 |  |
| 19 | USER_POINTS_LOG | 用户积分流水 |  |
| 20 | USER_FAVORITES | 用户收藏 |  |
| 21 | USER_BROWSING_HISTORY | 用户浏览历史记录 |  |
| 22 | USER_BEHAVIOR  | 用户行为信息收集 |  |
| 23 | ORDERS | 订单信息 |  |
| 24 | ORDER_ITEMS | 订单条目信息 |  |
| 25 | NOTIFICATIONS | 通知消息 |  |
| 26 | USER_NOTIFICATION_REL | 用户与通知关联 |  |
| 27 | REPORTS | 举报信息 |  |
| 28 | FEEDBACK | 反馈信息 |  |
| 29 | SHOOTING_PREVIEWS | 拍摄预告 |  |
| 30 | PHOTOGRAPHER_PORTFOLIO_REL | 摄影师作品关联表 |  |
| 31 | USER_SETTINGS | 用户个性化配置 |  |
| 32 | ARTICLES | 图文信息 |  |
| 33 | PHOTOGRAPHER_EARNINGS | 摄影师收益流水 |  |
| 34 | PAYOUTS | 提现记录 |  |
| 35 | ACTION_LOGS | 操作日志 |  |
| 36 | ERROR_LOGS | 错误日志 |  |
| 37 | LOGIN_LOGS | 登录日志 |  |
| 38 | API_LOGS | 接口请求日志 |  |
| 39 | OPERATION_AUDIT | 字段级变更审计日志 |  |
| 40 | SMS_LOGS | 短信/验证码发送日志 |  |
| 41 | TASK_EXECUTION_LOGS | 定时任务执行日志 |  |
| 42 | ORDER_LOGS | 订单操作日志 |  |
| 43 | SYSTEM_CONFIG | 系统配置表 |  |
| 44 | IMAGE_EXIF | 图片其他exif信息表 | 待设计 |
| 45 | WORKER_DETAIL | 工作人员详细信息 | 待设计 |
| 46 | EVENT_IMAGE_EXTRA  | 赛事图片额外信息表 | 待设计 |
| 47 | CONVERSATIONS | 客服会话表 | 待设计 |
| 48 | MESSAGES | 客服消息表 | 待设计 |

## 表字段明细

### **WORKERS [工作人员信息]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 主键 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | position | 职位 | VARCHAR(64) | INDEX(position) |  |  | 如摄影师、管理员等 |
| 3 | nickname | 昵称 | VARCHAR(64) |  |  |  |  |
| 4 | organization | 所属组织/公司/账号 | VARCHAR(128) |  |  |  |  |
| 5 | avatar_path | 头像存储路径 | VARCHAR(255) |  |  |  |  |
| 6 | real_name | 真实姓名(或备注名) | VARCHAR(64) |  |  |  |  |
| 7 | remark | 备注 | VARCHAR(255) |  |  |  |  |
| 8 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 9 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 10 | is_deleted | 逻辑删除标记 | TINYINT | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **EVENTS[赛事/活动信息]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 主键 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | event_name | 活动名称 | VARCHAR(255) |  | √ |  |  |
| 3 | event_desc | 活动描述 | TEXT |  |  |  |  |
| 4 | event_type | 活动类型 | TINYINT |  |  |  | 如0=赛事，1=活动 |
| 5 | organizer | 主办方名称 | VARCHAR(255) |  |  |  |  |
| 6 | event_date | 举办日期 | DATE |  |  |  |  |
| 7 | start_time | 开始时间 | DATETIME |  |  |  |  |
| 8 | end_time | 结束时间 | DATETIME |  |  |  |  |
| 9 | location_id | 赛事地点 | INT |  |  |  | 外键 -> LOCATION(id) |
| 10 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 11 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 12 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **EVENT_GROUPS[赛事/活动组别信息]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 主键 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | event_id | 赛事/活动id | INT | INDEX(event_id) | √ |  | 外键 -> EVENTS(id) |
| 3 | group_name | 组别名称 | VARCHAR(64) |  | √ |  |  |
| 4 | group_desc | 组别描述 | VARCHAR(255) |  | √ |  |  |
| 5 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 6 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 7 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **LOCATION[地点信息]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | province | 省份 | VARCHAR(64) |  |  |  |  |
| 3 | city | 城市 | VARCHAR(64) |  |  |  |  |
| 4 | district | 辖区/县 | VARCHAR(64) |  |  |  |  |
| 5 | address | 具体地点名称 | VARCHAR(255) |  |  |  |  |
| 7 | lat | 纬度（可选） | DECIMAL(10,6) |  |  |  |  |
| 8 | lng | 经度（可选） | DECIMAL(10,6) |  |  |  |  |
| 9 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 10 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 11 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **IMAGE_GROUPS[图片组信息]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | shoot_time | 拍摄时间 | DATETIME | INDEX(shoot_time) |  |  |  |
| 3 | location_id | 地点 | INT | INDEX(location_id) |  |  | 外键 -> LOCATION(id) |
| 4 | photographer_id | 摄影师 | INT | INDEX(photographer_id) |  |  | 外键 -> WORKERS(id) |
| 5 | post_processor_id | 后期 | INT |  |  |  | 外键 -> WORKERS(id) |
| 6 | event_id | 赛事/活动 | INT | INDEX(event_id) |  |  | 外键 -> EVENTS(id) |
| 7 | event_group_id | 组别 | INT |  |  |  | 外键 -> EVENT_GROUPS(id) |
| 8 | cover_image_path | 封面图路径 | VARCHAR(255) |  |  |  |  |
| 9 | tags | 标签 | VARCHAR(255) |  |  |  | 标签(如[精选,官方])，可存JSON或逗号分隔 |
| 10 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 11 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 12 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **IMAGES[单张图片信息]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | original_path | 原图路径 | VARCHAR(255) |  | √ |  |  |
| 3 | preview_path | 预览图路径 | VARCHAR(255) |  | √ |  |  |
| 4 | cover_path | 封面图路径 | VARCHAR(255) |  |  |  |  |
| 5 | audit_status | 审核状态 | TINYINT | INDEX(audit_status) | √ | 0 | 0=待审核,1=审核通过,2=审核驳回(示例) |
| 6 | audit_remark | 审核备注 | VARCHAR(255) |  |  |  | 记录审核人员的意见、拒绝理由等 |
| 7 | shoot_time | 拍摄时间 | DATETIME |  |  |  |  |
| 8 | location_id | 地点 | INT |  |  |  | 外键 -> LOCATION(id) |
| 9 | jersey_color | 骑行服颜色 | VARCHAR(32) | INDEX(jersey_color) |  |  | 如"红","蓝","黑"等，也可做枚举表或统一色值策略 |
| 10 | pants_color | 骑行裤颜色 | VARCHAR(32) | INDEX(pants_color) |  |  | 同上 |
| 11 | shoe_color | 鞋子颜色 | VARCHAR(32) | INDEX(shoe_color) |  |  | 同上 |
| 12 | bike_type | 车型 | VARCHAR(32) | INDEX(bike_type) |  |  | 例如 "公路车","摩托车","其他” |
| 13 | original_resolution | 原图清晰度 | VARCHAR(32) |  |  |  | 如1920X1080 |
| 14 | preview_resolution | 预览图清晰度 | VARCHAR(32) |  |  |  | 同上 |
| 15 | camera_model | 相机型号 | VARCHAR(128) |  |  |  | 相机型号 |
| 16 | lens_model | 镜头型号 | VARCHAR(128) |  |  |  | 镜头型号 |
| 17 | shutter_speed | 快门速度 | VARCHAR(32) |  |  |  |  |
| 18 | aperture | 光圈值 | VARCHAR(32) |  |  |  |  |
| 19 | iso | 感光度 | VARCHAR(32) |  |  |  |  |
| 20 | ev | EV值 | VARCHAR(32) |  |  |  |  |
| 21 | white_balance | 白平衡 | VARCHAR(32) |  |  |  |  |
| 22 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 23 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 24 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **IMAGE_GROUP_REL[图片与图片组关系]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | image_id | 图片id | INT | PRIMARY KEY(image_id, image_group_id) | √ |  |  |
| 2 | image_group_id | 图片组id | INT | PRIMARY KEY(image_id, image_group_id) | √ |  |  |
| 3 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 4 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 5 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **IMAGE_POST_SERVICE[后期处理服务]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | service_name | 服务名称 | VARCHAR(64) |  |  |  | 如"精修","去水印","换背景","人像美化"等 |
| 3 | service_desc | 服务描述 | VARCHAR(255) |  |  |  |  |
| 4 | base_price | 基础价格 | DECIMAL(10,2) |  |  | 0.00 | 可选：表示该服务的基础费用(若有定价) |
| 5 | remark | 备注 | VARCHAR(255) |  |  |  |  |
| 6 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 7 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 8 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **IMAGE_SERVICE_REL[后期处理服务与图片关联]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  | 主键 |
| 2 | image_id | 图片ID | INT | INDEX(image_id) + UNIQUE KEY(image_id, service_id, is_deleted) |  |  | 外键 -> IMAGES(id)，与`service_id`建立唯一组合索引 |
| 3 | service_id | 后期服务ID | INT | INDEX(service_id) + UNIQUE KEY(image_id, service_id, is_deleted) |  |  | 外键 -> IMAGE_POST_SERVICE(id) |
| 4 | custom_price | 服务价格 | DECIMAL(10,2) |  |  |  | 针对本图片的自定义服务价 |
| 5 | remark | 备注 | VARCHAR(255) |  |  |  |  |
| 6 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 7 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 8 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **IMAGE_SALES[图片销售/定价信息]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | image_id | 图片id | INT | UNIQUE INDEX (image_id) | √ |  | 外键 -> IMAGES(id) |
| 3 | base_price | 基础销售价 | DECIMAL(10,2) |  |  | 0.00 | 原价 |
| 4 | discount_price | 统一折扣价 | DECIMAL(10,2) |  |  | 0.00 | 全局统一折扣价，可为空，或存“折扣率” |
| 5 | points_need | 兑换所需积分 | INT |  |  | 0 | (可选)积分兑换所需积分 |
| 6 | currency | 币种 | VARCHAR(16) |  |  | 'CNY’ | (如 CNY, USD)，方便以后国际化 |
| 7 | start_time | 活动开始时间 | DATETIME | INDEX (start_time, end_time) |  |  | (可选)限时优惠开始时间 |
| 8 | end_time | 活动结束时间 | DATETIME |  |  |  | 同上 |
| 9 | remark | 备注 | VARCHAR(255) |  |  |  | 如促销信息说明等 |
| 10 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 11 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 12 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **DISCOUNT_POLICY[折扣策略]**

用于定义各种优惠策略，如新用户折扣、满减、积分兑换优惠等

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | policy_name | 折扣策略名称 | VARCHAR(128) |  | √ |  | 策略名称，如“新用户折扣” |
| 3 | policy_type | 折扣策略类型 | VARCHAR(32) | INDEX (policy_type) | √ |  | 如“折扣率”、“满减”、“积分兑换”，可用ENUM |
| 4 | discount_value | 折扣因子 | DECIMAL(10,2) |  | √ | 0.00 | （如0.9表示九折）或直接金额（满减时） |
| 5 | min_purchase | 最低消费金额 | DECIMAL(10,2) |  |  | 0.00 | 满减策略下的最低消费金额（非必填） |
| 6 | max_discount_value | 最高抵扣金额 | DECIMAL(10,2) |  |  |  |  |
| 7 | start_time | 策略生效开始时间 | DATETIME | INDEX (start_time, end_time) | √ | now() |  |
| 8 | end_time | 策略生效结束时间 | DATETIME |  |  |  | 若为空表示长期有效 |
| 9 | applicable_to_all | 适用商品 | TINYINT |  | √ | 0 | 0=仅部分商品/用户适用，1=全部适用 |
| 10 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 11 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 12 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **POLICY_IMAGE[折扣策略与图片关联]**

用于指定某一优惠策略仅对部分图片生效。

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | policy_id | 折扣策略id | INT | PRIMARY KEY (policy_id, image_id) | √ |  | 外键 -> DISCOUNT_POLICY(id) |
| 2 | image_id | 图片id | INT | PRIMARY KEY (policy_id, image_id) | √ |  | 外键 -> IMAGES(id)；与`policy_id`建立复合主键 |
| 3 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 4 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 5 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **POLICY_USER_GROUP[折扣策略与用户分组关联]**

用于指定某一优惠策略仅对部分用户群体生效。

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | policy_id | 折扣策略id | INT | PRIMARY KEY (policy_id, user_group_id) | √ |  | 外键 -> DISCOUNT_POLICY(id) |
| 2 | user_group_id | 用户组id | INT | PRIMARY KEY (policy_id, user_group_id) | √ |  | 外键 -> USER_GROUP(id)；与`policy_id`建立复合主键 |
| 3 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 4 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 5 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

---

> 后台算法提示：
> 
> - 对于“新用户折扣”等基于时间条件的策略，不需要在数据库中额外存储“是否新用户”，而是根据 USER.create_time 与当前时间动态判断（例如注册时间在三个月内，则认为符合新用户条件）。

### **USER_GROUP[用户分组/会员等级]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | group_name | 用户组名称 | VARCHAR(64) |  |  |  | （如“VIP会员”） |
| 3 | description | 用户组描述 | VARCHAR(255) |  |  |  |  |
| 4 | base_discount | 默认折扣因子 | DECIMAL(5,2) |  |  | 1.00 | 如0.95表示享受95折优惠 |
| 5 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 6 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 7 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **USER_GROUP_REL[用户与分组关联]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | user_id | 用户id | INT | PRIMARY KEY(user_id, user_group_id) | √ |  | 外键 -> USER(id)；与`user_group_id` 建立复合主键 |
| 2 | user_group_id | 用户组id | INT | PRIMARY KEY(user_id, user_group_id) | √ |  | 外键 -> USER_GROUP(id) |
| 3 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 4 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 5 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **COUPONS[优惠券信息]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | coupon_code | 优惠券代码 | VARCHAR(32) | UNIQUE INDEX(coupon_code) | √ |  | 唯一；建立唯一索引 |
| 3 | coupon_type | 优惠券类型 | VARCHAR(32) |  | √ |  | 如“满减”、“折扣” |
| 4 | discount_value | 折扣因子 | DECIMAL(10,2) |  | √ | 0.00 | 折扣金额或折扣因子（如0.8表示八折） |
| 5 | min_purchase | 最低消费金额 | DECIMAL(10,2) |  |  | 0.00 | 满减优惠时的最低消费金额（可选） |
| 6 | start_time | 有效开始时间 | DATETIME | INDEX(start_time, end_time) | √ | now() |  |
| 7 | end_time | 有效结束时间 | DATETIME |  |  |  | 若为空表示长期有效 |
| 8 | applicable_to_all | 适用范围 | TINYINT |  | √ | 0 | 0=仅部分图片/用户适用，1=全部适用 |
| 9 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 10 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 11 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **USER_COUPONS[用户优惠券]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | coupon_id | 优惠券id | INT | INDEX(coupon_id) | √ |  | 外键 -> COUPONS(id) |
| 3 | user_id | 用户id | INT | INDEX(user_id) | √ |  | 外键 -> USER(id) |
| 4 | status | 使用状态 | TINYINT | INDEX(status) | √ | 0 | 0=未使用, 1=已使用, 2=已过期 |
| 5 | use_time | 优惠券使用时间 | DATETIME |  |  |  |  |
| 6 | order_id | 订单id | INT | INDEX(order_id) |  |  | 外键 -> ORDERS(id)，使用优惠券的订单id |
| 7 | create_time | 创建时间 | DATETIME |  | √ | now() | 发放时间 |
| 8 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 9 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **USER[用户信息]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | nickname | 昵称 | VARCHAR(128) |  |  |  |  |
| 3 | mobile_phone | 手机号 | VARCHAR(32) | UNIQUE INDEX(mobile_phone,is_deleted) |  |  | 建立唯一索引 |
| 4 | avatar | 头像 | VARCHAR(128) |  |  |  | 路径orURL |
| 5 | gender | 性别 | TINYINT |  |  |  | 0=不透露/其他，1=男，2=女 |
| 6 | birth_date  | 出生日期 | DATE |  |  |  |  |
| 7 | email  | 邮箱(选填) | VARCHAR(128) |  |  |  | 发票、账单等国际化/专业用户场景 |
| 8 | points | 积分余额 | INT |  |  | 0 |  |
| 9 | open_id | 用户微信id | VARCHAR(128) | UNIQUE INDEX(open_id, is_deleted) |  |  | 微信身份标识；建立唯一索引 |
| 10 | real_name  | 真实姓名 |  VARCHAR(16) |  |  |  | 实名信息 |
| 11 | id_number | 身份证号 | VARCHAR(32) |  |  |  | 实名信息 |
| 12 | status | 账号状态 | TINYINT | INDEX(status) | √ | 0 | 0=正常，1=封禁，2=黑名单等 |
| 13 | source | 注册来源 | VARCHAR(64) |  |  |  | 如微信、某平台二维码等 |
| 14 | last_login_time | 最后登录时间 | DATETIME |  |  |  |  |
| 15 | create_time | 创建时间 | DATETIME | INDEX(create_time) | √ | now() | 索引目的：如“最近注册用户” |
| 16 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 17 | remark | 备注 | VARCHAR(512) |  |  |  |  |
| 18 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **USER_POINTS_LOG[用户积分流水]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | user_id | 用户id | INT | INDEX(user_id) | √ |  | 外键 -> USER(id) |
| 3 | change_amount | 本次积分变动值 | INT |  | √ |  | （正数=增加，负数=减少） |
| 4 | change_type | 变动类型 | VARCHAR(32) |  | √ |  | 如 purchase, exchange, event_bonus, admin_adjust 等 |
| 5 | source_id | 来源ID | INT |  |  |  | 如订单ID、活动ID，便于追踪 |
| 6 | source_type | 来源类型 | VARCHAR(32) |  |  |  | 如 order, event, system |
| 7 | remark | 变动原因备注 | TEXT |  |  |  | 变动原因的文字说明 |
| 8 | expiry_time | 过期时间 | DATETIME |  |  |  | 如空则为永久有效积分 |
| 9 | current_balance | 变动后积分余额 | INT |  | √ |  | 快照，可选 |
| 10 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 11 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 12 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **CART_ITEMS[用户购物车条目]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | user_id | 用户id | INT | INDEX(user_id) | √ |  | 外键 -> USER(id) |
| 3 | item_type | 商品类型 | VARCHAR(32) |  | √ |  | 如 'IMAGE', 'SERVICE'。用于区分 item_id 指向哪个表 |
| 4 | item_id | 商品ID | INT |  | √ |  | 对应 IMAGES(id) 或 IMAGE_POST_SERVICE(id) 等 |
| 5 | quantity | 数量 | INT |  | √ | 1 | 对于独特的数字图片通常为1，服务或其他未来商品可能允许大于1 |
| 6 | price_at_add | 加入时价格 | DECIMAL(10, 2) |  |  | NULL | 可选：记录商品加入购物车时的价格快照，防止后续价格变动影响购物车显示 |
| 7 | session_id | 会话ID | VARCHAR(64) | INDEX(session_id) |  | NULL | 用于关联匿名用户的购物车内容，登录后应合并至 user_id 并清空此字段 |
| 8 | added_at | 添加时间 | DATETIME |  | √ | now() | 商品加入购物车的时间 |
| 9 | updated_at | 更新时间 | DATETIME |  | √ | now() | 记录更新时间 (如修改数量) |
| 10 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常在购物车中, 1=已移除) |
|  |  |  |  | UNIQUE KEY uk_user_item (user_id, item_type, item_id, is_deleted) |  |  | 防止同一登录用户重复添加相同未删除项 (若 quantity 始终为1) |
|  |  |  |  | INDEX idx_user_session_item (user_id, session_id, is_deleted) |  |  | 优化查询用户购物车 |

### **USER_FAVORITES[用户收藏]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | user_id | 用户id | INT | INDEX(user_id, favorite_type, target_id) | √ |  | 外键 -> USER(id)，索引描述：避免重重收藏对象 |
| 3 | favorite_type | 收藏对象类型 | INT | INDEX(user_id, favorite_type, target_id) | √ |  | 如 "image", "album", "article", "photographer” |
| 4 | target_id | 收藏对象ID | INT | INDEX(user_id, favorite_type, target_id) | √ |  |  |
| 5 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 6 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 7 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **USER_BROWSING_HISTORY[用户浏览历史记录]**

为了与业务日志（USER_BEHAVIOR）区分，将用户的历史浏览记录单独存放。便于用户查看历史足迹、清除记录等操作。

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | user_id | 用户id | INT | INDEX(user_id, target_type, target_id) | √ |  | 外键 -> USER(id) |
| 3 | target_type | 浏览对象类型 | INT | INDEX(user_id, target_type, target_id) | √ |  | 如 "image", "album", "article” |
| 4 | target_id | 浏览对象ID | INT | INDEX(user_id, target_type, target_id) | √ |  |  |
| 5 | view_time | 创建时间 | DATETIME | INDEX(view_time) | √ | now() | 索引：支持时间排序快速查“最近浏览” |
| 6 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 7 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **USER_BEHAVIOR [用户行为信息收集]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | user_id | 用户id | INT | INDEX (user_id,) | √ |  | 外键 -> USER(id) |
| 3 | behavior_type | 行为类型 | VARCHAR(32) | INDEX (behavior_type) | √ |  | (如 view_image, add_to_cart等) |
| 4 | target_id | 针对对象id | INT |  |  |  | (可能是image_id或image_group_id等) |
| 5 | session_id | 会话标识符 | VARCHAR(64) | INDEX (session_id) |  |  | 将用户多个行为关联起来 |
| 6 | action_duration | 行为持续时间 | INT |  |  |  | （单位：秒） |
| 7 | source_page | 行为来源页面 | VARCHAR(128) |  |  |  | 来源页面URL或编码 |
| 8 | behavior_context | 行为上下文环境 | VARCHAR(255) |  |  |  | 如浏览设备、系统语言、是否首次访问等，JSON存储 |
| 9 | ip_address | 用户IP地址 | VARCHAR(45) |  |  |  | 浏览器或客户端信息 |
| 10 | user_agent | 浏览器或客户端信息 | VARCHAR(255) |  |  |  | 浏览器或客户端信息 |
| 11 | create_time | 行为发生时间 | DATETIME | INDEX (create_time) | √ | now() |  |
| 12 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 13 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **ORDERS [订单信息]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | order_no | 订单号 | VARCHAR(64) | UNIQUE INDEX(order_no) | √ |  | (可自行生成，如时间戳+随机数)，唯一索引 |
| 3 | user_id | 用户id | INT | INDEX(user_id) | √ |  | 外键 -> USER(id) |
| 4 | total_original_price | 原价合计 | DECIMAL(10,2) |  | √ | 0.00 | 订单所有商品原价合计 |
| 5 | total_discount_price | 总优惠金额 | DECIMAL(10,2) |  | √ | 0.00 | 各种折扣、优惠券、积分抵扣的总和 |
| 6 | total_final_price | 实际支付金额 | DECIMAL(10,2) |  | √ | 0.00 | 扣除优惠、使用优惠券等后的最终支付金额 |
| 7 | status | 订单状态 | TINYINT | INDEX(status) | √ | 0 | (0=待支付,1=已支付,2=处理中(如服务),3=已完成,4=已取消,5=退款中,6=已退款) |
| 8 | pay_method | 支付方式 | VARCHAR(32) | INDEX(pay_method) |  |  | 如 'WECHAT_PAY', 'ALIPAY', 'POINTS', 'BALANCE' |
| 9 | payment_gateway | 支付网关 | VARCHAR(32) |  |  |  | 如 'WECHAT', 'ALIPAY', 'SYSTEM' (积分/余额支付) |
| 10 | transaction_id | 支付流水号 | VARCHAR(128) | INDEX(transaction_id) |  |  | 支付网关返回的交易号 |
| 11 | pay_time | 支付时间 | DATETIME | INDEX(pay_time) |  |  | 支付成功时间 |
| 12 | create_time | 下单时间 | DATETIME | INDEX(create_time) | √ | now() |  |
| 13 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 14 | remark | 订单备注 | VARCHAR(512) |  |  |  |  |
| 15 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **ORDER_ITEMS [订单条目信息]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | order_id | 订单id | INT | INDEX(order_id) | √ |  | 外键 -> ORDERS(id) |
| 3 | item_type | 商品类型 | VARCHAR(32) |  | √ |  | 如：'IMAGE'（图片）、'SERVICE'（服务） |
| 4 | item_id | 商品id | INT |  | √ |  | 若 item_type=IMAGE，则为 IMAGES(id)；若为服务，则为相应服务表ID（如 IMAGE_POST_SERVICE(id)） |
| 5 | item_name | 商品名称快照 |  VARCHAR(255) |  |  |  | 可选：记录购买时商品名称 |
| 6 | original_price | 商品原价 | DECIMAL(10,2) |  | √ | 0.00 |  |
| 7 | discount_price | 折扣后价格 | DECIMAL(10,2) |  | √ | 0.00 | 如存在优惠折扣 |
| 8 | final_price | 实际支付价格 | DECIMAL(10,2) |  | √ | 0.00 | 可能经过额外优惠后调整 |
| 9 | quantity | 购买数量 | INT |  | √ | 1 | 服务通常为1 |
| 10 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 11 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 12 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### NOTIFICATIONS[通知消息]

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 通知ID | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | title | 通知标题 | VARCHAR(128) |  | √ |  | 简短标题，如“订单已支付” |
| 3 | content | 通知内容 | TEXT |  | √ |  | 富文本支持；提示/说明文字 |
| 4 | notify_type | 通知类型 | TINYINT | INDEX | √ |  | 系统、交易、运营、客服等 |
| 5 | push_type | 推送方式 | TINYINT |  | √ | 'system' | 如：system（站内）、sms、email、wx |
| 6 | target_user_id | 接收用户ID | INT | INDEX |  | NULL | NULL 表示全体广播 |
| 7 | action_url | 动作链接 | VARCHAR(255) |  |  |  | 点击跳转链接（如订单详情） |
| 8 | send_time | 通知时间 | DATETIME | INDEX | √ | now() |  |
| 9 | expire_time | 失效时间 | DATETIME |  |  |  | 过期后不再展示 |
| 10 | status | 状态 | TINYINT |  | √ | 0 | 0=待发送,1=已发送,2=已撤回 |
| 11 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

通知类型建议

| `system` | 系统维护/升级 |
| --- | --- |
| `order` | 支付成功、退款成功 |
| `event` | 活动开赛、报名成功 |
| `image` | 图片已审核、处理完成 |
| `message` | 客服沟通或站内私信 |

### USER_NOTIFICATION_REL[用户与通知关联]

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | user_id | 用户ID | INT | INDEX | √ |  | 外键 → USER(id) |
| 3 | notification_id | 通知ID | INT | INDEX | √ |  | 外键 → NOTIFICATIONS(id) |
| 4 | read_status | 阅读状态 | TINYINT | INDEX | √ | 0 | 0=未读，1=已读 |
| 5 | read_time | 阅读时间 | DATETIME |  |  |  | 若已读则记录时间 |
| 6 | create_time | 关联创建时间 | DATETIME |  | √ | now() | 插入时间 |
| 7 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX | √ | 0 |  |

### **REPORTS[举报信息表]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | user_id | 举报用户ID | INT | INDEX(user_id) | √ |  | 外键 -> USER(id) |
| 3 | target_type | 举报对象类型 | VARCHAR(64) |  | √ |  | 如：image_group、image、user、comment、feedback 等 |
| 4 | target_id | 举报对象ID | INT |  | √ |  | 与 target_type 联合定位目标（不设 FK 便于兼容多表） |
| 5 | report_type | 举报类型 | VARCHAR(64) |  |  |  | 如：肖像权、不当内容、版权问题、骚扰行为 等 |
| 6 | report_content | 举报描述 | TEXT |  |  |  | 举报理由或说明 |
| 7 | status | 处理状态 | TINYINT | INDEX(status) | √ | 0 | 0=未处理，1=处理中，2=处理完毕 |
| 8 | handle_remark | 处理备注 | VARCHAR(255) |  |  |  | 处理意见或说明 |
| 9 | handle_time | 处理时间 | DATETIME |  |  |  |  |
| 10 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 11 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 12 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **FEEDBACK[反馈信息]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | user_id | 用户id | INT | INDEX(user_id) |  |  | 外键 -> USER(id) |
| 3 | feedback_type | 问题类型 | TINYINT |  |  |  | 如1=意见，2=建议 |
| 4 | feedback_content | 反馈信息正文 | TEXT |  | √ |  |  |
| 5 | status | 处理状态 | TINYINT | INDEX(status) | √ | 0 | (0=未处理,1=处理中,2=已处理等) |
| 6 | contact_number | 联系方式 | VARCHAR(32) |  |  |  |  |
| 7 | create_time | 反馈提交时间 | DATETIME |  | √ | now() |  |
| 8 | update_time | 处理更新时间 | DATETIME |  | √ | now() |  |
| 9 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **SHOOTING_PREVIEWS[拍摄预告]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | worker_id | 摄影师ID | INT | INDEX(worker_id) | √ |  |  |
| 3 | scheduled_start_time | 预定拍摄开始时间 | DATETIME | INDEX((scheduled_start_time, scheduled_end_time)) | √ |  |  |
| 4 | scheduled_end_time | 预定拍摄结束时间 | DATETIME | INDEX((scheduled_start_time, scheduled_end_time)) | √ |  |  |
| 5 | location_id | 拍摄地点 | INT | INDEX(location_id) | √ |  | 外键 -> LOCATION(id) |
| 6 | description | 预告描述信息 | TEXT |  |  |  | 可包含拍摄主题、注意事项等 |
| 7 | create_time | 反馈提交时间 | DATETIME |  | √ | now() |  |
| 8 | update_time | 处理更新时间 | DATETIME |  | √ | now() |  |
| 9 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### PHOTOGRAPHER_PORTFOLIO_REL[摄影师作品关联表]

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | worker_id | 摄影师ID | INT | PRIMARY KEY(worker_id, image_id) | √ |  | 外键 → WORKERS(id) |
| 2 | image_id | 图片ID | INT | PRIMARY KEY(worker_id, image_id) | √ |  | 外键 → IMAGES(id) |
| 3 | sort_order | 排序号 | INT | INDEX |  | 0 | 控制前端展示顺序（越小越靠前） |
| 4 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 5 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 8 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **USER_SETTINGS[ 用户个性化配置]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | user_id | 用户ID | INT | INDEX(user_id) | √ |  |  |
| 3 | config_key | 配置项名称 | VARCHAR(64) | UNIQUE INDEX (user_id, config_key) | √ |  | 如 theme, notification, privacy |
| 4 | config_value | 配置项的值 | TEXT |  | √ |  | 采用 TEXT 类型以支持较长内容 |
| 5 | description |  |  |  |  |  | 配置项说明（可选） |
| 6 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 7 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 8 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **ARTICLES[图文信息]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | title | 文章标题 | VARCHAR(255) |  | √ |  |  |
| 3 | slug | URL标识符 | VARCHAR(128) |  | √ |  | 友好URL标识符，便于 SEO |
| 4 | content | 文章内容 | TEXT |  |  |  | Markdown 格式 |
| 5 | summary | 文章摘要 | VARCHAR(512) |  |  |  | 文章摘要或预览文本 |
| 6 | cover_image | 封面图片路径 | VARCHAR(128) |  |  |  | 封面图片路径 |
| 7 | author_id | 作者id | INT | INDEX(author_id) |  |  | 外键 -> USER(id) 或 WORKERS(id) |
| 8 | published_time | 发布时间 | DATETIME | INDEX(published_time) |  |  |  |
| 9 | status | 文章状态 | TINYINT | INDEX(status) |  | 0 | 状态：0=草稿, 1=已发布 |
| 10 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 11 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 12 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **PHOTOGRAPHER_EARNINGS [摄影师收益流水表]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | worker_id | 摄影师ID | INT | INDEX(worker_id) | √ |  | 外键 -> WORKERS(id) |
| 3 | order_item_id | 订单条目ID | INT | INDEX(order_item_id) | √ |  | 外键 -> ORDER_ITEMS(id) |
| 4 | image_id | 关联图片ID | INT | INDEX(image_id) | √ |  | 外键 -> IMAGES(id) |
| 5 | earning_amount | 收益金额 | DECIMAL(10,2) |  | √ | 0.00 | 该订单条目为摄影师带来的分成金额 |
| 6 | commission_rate | 分成比例 | DECIMAL(5,4) |  | √ | 0.0000 | 结算时使用的分成比例 (如 0.7000) |
| 7 | transaction_time | 交易时间 | DATETIME | INDEX(transaction_time) | √ | now() | 通常是订单支付完成时间 |
| 8 | status | 结算状态 | TINYINT | INDEX(status) | √ | 0 | 0=待结算, 1=已结算(进入可提现), 2=已提现, 3=异常 |
| 9 | remark | 备注 | VARCHAR(255) |  |  |  |  |
| 10 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 11 | update_time | 更新时间 | DATETIME |  | √ | now() |  |

### **PAYOUTS[提现记录表]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | worker_id | 申请人ID | INT |  | √ |  | 外键 -> WORKERS(id) |
| 3 | payout_no | 提现单号 | VARCHAR(64) | UNIQUE INDEX | √ |  | 唯一提现申请编号 |
| 4 | amount | 提现金额 | DECIMAL(10,2) |  | √ | 0.00 |  |
| 5 | fee | 手续费 | DECIMAL(10,2) |  | √ | 0.00 | 平台或支付渠道收取的手续费 |
| 6 | actual_amount | 实际到账金额 | DECIMAL(10,2) |  | √ | 0.00 | amount - fee |
| 7 | payout_method | 提现方式 | VARCHAR(32) |  | √ |  | 如 'BANK_TRANSFER', 'ALIPAY', 'WECHAT' |
| 8 | account_info | 收款账户信息 | TEXT |  | √ |  | 加密存储银行卡号/支付宝账号等 |
| 9 | status | 提现状态 | TINYINT | INDEX(status) | √ | 0 | 0=申请中, 1=处理中, 2=已完成, 3=失败/驳回 |
| 10 | apply_time | 申请时间 | DATETIME | INDEX(apply_time) | √ | now() |  |
| 11 | complete_time | 完成时间 | DATETIME |  |  |  | 提现成功或失败的时间 |
| 12 | transaction_id | 支付平台流水号 | VARCHAR(128) |  |  |  | 转账成功后的外部流水号 |
| 13 | remark | 备注/失败原因 | VARCHAR(255) |  |  |  |  |
| 14 | handled_by | 处理人ID | INT |  |  |  | 外键 -> WORKERS(id), 审核或处理提现的管理员 |
| 15 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 16 | update_time | 更新时间 | DATETIME |  | √ | now() |  |

### **ACTION_LOGS[操作日志]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | action_type | 操作类型 | TINYINT | INDEX(action_type) | √ |  | 如：1=创建、2=更新、3=删除 |
| 3 | action_user | 操作员 | INT | INDEX(action_user) | √ |  | 外键 -> WORKERS(id) |
| 4 | target_table | 操作的表 | VARCHAR(64) | INDEX((target_table, target_id)) | √ |  | 被操作的数据表名称 |
| 5 | target_id | 操作的记录ID | INT | INDEX((target_table, target_id)) | √ |  | 被操作的数据记录的主键ID |
| 6 | action_time | 操作时间 | DATETIME | INDEX(action_time) | √ | now() | 操作发生的具体时间 |
| 7 | remark | 备注 | TEXT |  |  |  | 可记录具体字段变化、IP、操作来源等 |

### **ERROR_LOGS[**错误日志**]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | error_code | 错误代码 | VARCHAR(64) |  |  |  | 自定义错误码，如 E1001 |
| 3 | error_message | 错误消息 | TEXT |  | √ |  | 简要错误描述 |
| 4 | error_stack | 错误堆栈 | TEXT |  | √ |  | 异常堆栈详情 |
| 5 | error_time | 发生时间 | DATETIME |  | √ | now() |  |
| 6 | is_resolved | 是否已解决 | BOOLEAN | INDEX(is_resolved) | √ | 0 | (0=未解决) |

### **LOGIN_LOGS[登录日志]**

记录用户或工作人员登录行为，含IP、设备信息、登录状态等。

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | user_type | 用户类型 | TINYINT | INDEX | √ |  | 1=用户，2=工作人员等 |
| 3 | user_id | 用户ID | INT | INDEX | √ |  | 对应 USER 或 WORKERS 表 |
| 4 | login_result | 登录结果 | TINYINT | INDEX | √ | 1 | 1=成功，0=失败 |
| 5 | login_method | 登录方式 | VARCHAR(32) |  |  |  | 如手机号、验证码、微信、小程序等 |
| 6 | ip_address | 登录IP地址 | VARCHAR(45) |  |  |  | IPV4或IPV6 |
| 7 | user_agent | 客户端信息 | VARCHAR(255) |  |  |  | 浏览器/设备类型 |
| 8 | login_time | 登录时间 | DATETIME | INDEX | √ | now() |  |
| 9 | remark | 备注 | VARCHAR(255) |  |  |  | 如失败原因 |
| 10 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

### **API_LOGS[接口请求日志]**

记录服务端所有接口调用情况，便于追踪接口异常、性能瓶颈。

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | endpoint | 接口路径 | VARCHAR(255) | INDEX | √ |  | 如 `/api/image/upload` |
| 3 | method | 请求方式 | VARCHAR(8) |  | √ |  | GET / POST / PUT / DELETE |
| 4 | status_code | 响应状态码 | INT | INDEX | √ | 200 | 如 200, 401, 500 |
| 5 | response_time | 响应耗时(ms) | INT |  | √ |  | 单位：毫秒 |
| 6 | user_type | 用户类型 | VARCHAR(16) |  |  |  | user / worker / anonymous |
| 7 | user_id | 用户ID | INT | INDEX |  |  | 若登录用户存在则记录 |
| 8 | request_payload | 请求体摘要 | TEXT |  |  |  | 可存部分敏感脱敏内容 |
| 9 | response_message | 响应内容摘要 | TEXT |  |  |  | 记录返回信息（如失败原因） |
| 10 | request_ip | 请求IP地址 | VARCHAR(45) |  |  |  | IPV4或IPV6 |
| 11 | user_agent | 客户端信息 | VARCHAR(255) |  |  |  |  |
| 12 | request_time | 请求时间 | DATETIME | INDEX | √ | now() |  |

### **OPERATION_AUDIT[字段级变更审计日志]**

用于记录敏感字段的变更行为，例如修改了订单金额、用户状态等。

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | module_name | 模块名称 | VARCHAR(64) | INDEX | √ |  | 如：ORDER、USER、IMAGE |
| 3 | record_id | 记录ID | INT | INDEX | √ |  | 被修改的数据ID |
| 4 | field_name | 字段名称 | VARCHAR(64) |  | √ |  | 被修改的字段名称 |
| 5 | old_value | 修改前值 | TEXT |  |  |  |  |
| 6 | new_value | 修改后值 | TEXT |  |  |  |  |
| 7 | change_reason | 修改原因 | VARCHAR(255) |  |  |  | 人工填写或系统说明 |
| 8 | operator_id | 操作人ID | INT | INDEX | √ |  | 外键 -> WORKERS(id) |
| 9 | operate_time | 修改时间 | DATETIME | INDEX | √ | now() |  |

### **SMS_LOGS[短信/验证码发送日志]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | phone_number | 手机号 | VARCHAR(32) | INDEX | √ |  |  |
| 3 | template_type | 短信类型 | VARCHAR(32) | INDEX | √ |  | login / reset / verify 等 |
| 4 | content | 短信内容 | TEXT |  | √ |  | 实际发送内容（建议脱敏） |
| 5 | send_status | 发送状态 | TINYINT | INDEX | √ | 0 | 0=未发送，1=已发送，2=失败 |
| 6 | fail_reason | 失败原因 | VARCHAR(255) |  |  |  | 第三方接口返回错误消息 |
| 7 | ip_address | 请求IP | VARCHAR(45) |  |  |  | 防止同IP频繁请求 |
| 8 | user_agent | UA信息 | VARCHAR(255) |  |  |  | 可用于风控判断 |
| 9 | send_time | 发送时间 | DATETIME | INDEX | √ | now() |  |

### **TASK_EXECUTION_LOGS[定时任务执行日志]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | task_name | 任务名称 | VARCHAR(128) | INDEX | √ |  | 如：清理过期订单、自动打水印等 |
| 3 | task_type | 任务类型 | VARCHAR(64) | INDEX | √ |  | cron / interval / manual |
| 4 | trigger_time | 触发时间 | DATETIME | INDEX | √ | now() | 实际开始时间 |
| 5 | end_time | 结束时间 | DATETIME |  |  |  | 可计算耗时 |
| 6 | status | 执行状态 | TINYINT | INDEX | √ | 0 | 0=未执行,1=成功,2=失败 |
| 7 | result | 执行结果摘要 | TEXT |  |  |  | 可记录执行记录、错误内容等 |
| 8 | remark | 备注 | VARCHAR(255) |  |  |  |  |

### **ORDER_LOGS[订单操作日志]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | order_id | 订单ID | INT | INDEX | √ |  | 外键 -> ORDERS(id) |
| 3 | action_type | 操作类型 | VARCHAR(32) | INDEX | √ |  | 状态变更/退款/回调/金额改动等 |
| 4 | previous_status | 变更前状态 | TINYINT |  |  |  |  |
| 5 | new_status | 变更后状态 | TINYINT |  |  |  |  |
| 6 | changed_by | 操作人ID | INT |  |  |  | user_id 或 operator_id（系统操作可为NULL） |
| 7 | actor_type | 操作者类型 | VARCHAR(16) |  |  | 'user'/'worker'/'system' |  |
| 8 | description | 操作说明 | TEXT |  |  |  | 回调内容 / 手动修改说明等 |
| 9 | action_time | 操作时间 | DATETIME | INDEX | √ | now() |  |

### **SYSTEM_CONFIG[系统配置表]**

| / | 字段 | 名称 | 数据类型 | 主键/索引 | 非空 | 默认值 | 备注 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | id | 唯一标识符 | INT AUTO_INCREMENT | PRIMARY_KEY | √ |  |  |
| 2 | config_key | 配置键 | VARCHAR(128) | UNIQUE INDEX(config_key, is_deleted) | √ |  | 唯一配置项标识，如 'platform_commission_rate', 'default_image_price', 'wechat_app_id' |
| 3 | config_value | 配置值 | TEXT |  | √ |  | 存储配置的值 |
| 4 | description | 配置描述 | VARCHAR(255) |  |  |  | 说明该配置项的用途 |
| 5 | group_name | 配置分组 | VARCHAR(64) | INDEX |  | 'default' | 用于后台界面分组展示，如 'Payment', 'Storage', 'Notification' |
| 6 | is_public | 是否公开 | BOOLEAN |  | √ | 0 | 标记某些配置是否可以暴露给前端 (慎用) |
| 7 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 8 | update_time | 更新时间 | DATETIME |  | √ | now() |  |
| 9 | is_deleted | 逻辑删除标记 | BOOLEAN | INDEX(is_deleted) | √ | 0 | (0=正常) |

**IMAGE_EXIF [图片其他exif信息表] (预留)**

 **WORKER_DETAIL [工作人员详细信息] (预留)**

**EVENT_IMAGE_EXTRA [赛事图片额外信息表](用于后续如基于号码布检索等条件的存储，关联[images]表)**

**CONVERSATIONS [客服会话表]**

**MESSAGES [客服消息表]**

1. **折扣/定价信息:** IMAGE_SALES 有 base_price 和 discount_price。DISCOUNT_POLICY 定义了更复杂的策略。COUPONS 是另一种优惠。USER_GROUP 也有 base_discount。
    - **分析:** 存在多种定价和折扣方式。IMAGE_SALES.discount_price 像是一个全局的、简单的折扣价，可能与 DISCOUNT_POLICY 中的某些策略重叠。
    - **建议:** 梳理清楚价格计算逻辑和优先级。IMAGE_SALES.discount_price 是否必要？或者它代表的是一个不依赖任何策略的“特价”？建议优先使用 DISCOUNT_POLICY 和 COUPONS 来实现灵活的折扣，IMAGE_SALES 只存储基础原价 (base_price) 和可能的积分兑换价 (points_need)。用户组折扣 (USER_GROUP.base_discount) 应在计算最终价格时应用。
2. **颜色/车型字段:** IMAGES 表中的 jersey_color, pants_color, shoe_color, bike_type 使用 VARCHAR(32)。
    - **问题:** 如果颜色和车型种类繁多或需要精确匹配，文本比较效率较低，且容易因输入不一致（如“红色” vs “红”）导致查询遗漏。
    - 用字典表id替换文字
3. **日志表:** 大量的日志表 (ACTION_LOGS, ERROR_LOGS, LOGIN_LOGS, API_LOGS, OPERATION_AUDIT, SMS_LOGS, TASK_EXECUTION_LOGS, ORDER_LOGS)。
    1. **用户行为/浏览历史:** USER_BEHAVIOR 和 USER_BROWSING_HISTORY 可能会变得非常大。
    - **问题:** 虽然分离清晰，但如果日志量巨大，查询和维护成本会增加。特别是 API_LOGS 和 OPERATION_AUDIT 可能增长非常快。
    - **建议:**
        - 考虑使用专门的日志收集和分析系统（如 ELK Stack - Elasticsearch, Logstash, Kibana 或类似方案）来处理部分高频或非核心业务关联的日志（如 API_LOGS, ERROR_LOGS），减轻数据库压力。
        - 为这些日志表设置定期归档或清理策略。
        - 确保索引设置合理，特别是时间字段和常用查询字段。

- **管理员权限管理**: 缺少 ROLES, PERMISSIONS 相关表。
- **摄影师财务/结算**: 缺少 PHOTOGRAPHER_EARNINGS, PAYOUTS 或类似表来追踪摄影师收入、分成、提现记录。
- **图片处理状态**: 图片上传后通常有处理流程（如AI识别、打水印、审核），IMAGES 表缺少明确的状态字段来跟踪这些步骤 (当前只有 audit_status)。可以增加 processing_status 字段或单独的 IMAGE_PROCESSING_JOBS 表。
- **系统配置**: 缺少全局配置表 (SYSTEM_CONFIG)，用于存储如默认价格、平台抽成比例、第三方服务密钥等。

### 5. **数据统计/缓存类表（可选）**

如有：

- 用户画像画像分析结果缓存（如购买偏好、访问热图）
- 图片热度榜单（可写入 `IMAGE_STATS` 表）

### 🔸 6. **图片版权与授权管理（如你未来拓展版权服务）**

如果你平台允许摄影师标记版权、授权使用，可能用到：

- `IMAGE_LICENSES`：图片授权记录（授权给谁、时间、用途等）

---

### **WORKER_DETAIL [工作人员详细信息表] (模拟)**

| **/** | **字段** | **名称** | **数据类型** | **主键/索引** | **非空** | **默认值** | **备注** |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | worker_id | 工作人员ID | INT | PRIMARY_KEY | √ |  | 外键 -> WORKERS(id) |
| 2 | id_card_front | 身份证正面照片 | VARCHAR(255) |  |  |  | 存储路径 |
| 3 | id_card_back | 身份证反面照片 | VARCHAR(255) |  |  |  | 存储路径 |
| 4 | id_card_number | 身份证号 | VARCHAR(32) | INDEX |  |  | 可加密存储 |
| 5 | address | 联系地址 | VARCHAR(255) |  |  |  |  |
| 6 | emergency_contact_name | 紧急联系人姓名 | VARCHAR(64) |  |  |  |  |
| 7 | emergency_contact_phone | 紧急联系人电话 | VARCHAR(32) |  |  |  |  |
| 8 | bank_name | 开户行名称 | VARCHAR(128) |  |  |  | 用于提现 |
| 9 | bank_branch | 开户行支行 | VARCHAR(128) |  |  |  |  |
| 10 | bank_account_name | 银行账户名 | VARCHAR(64) |  |  |  |  |
| 11 | bank_account_number | 银行卡号 | VARCHAR(64) |  |  |  | 可加密存储 |
| 12 | alipay_account | 支付宝账号 | VARCHAR(128) |  |  |  |  |
| 13 | wechat_pay_account | 微信支付账号(如OpenID) | VARCHAR(128) |  |  |  |  |
| 14 | portfolio_url | 作品集链接 | VARCHAR(255) |  |  |  | 个人网站或第三方平台链接 |
| 15 | bio | 个人简介 | TEXT |  |  |  |  |
| 16 | verification_status | 认证状态 | TINYINT | INDEX | √ | 0 | 0=未认证, 1=审核中, 2=已认证, 3=认证失败 |
| 17 | verification_remark | 认证备注 | VARCHAR(255) |  |  |  | 审核意见 |
| 18 | create_time | 创建时间 | DATETIME |  | √ | now() |  |
| 19 | update_time | 更新时间 | DATETIME |  | √ | now() |  |

